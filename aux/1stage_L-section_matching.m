%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% @date        : Sat Mar 21 10:25:43 CET 2020
% @author(s)   : Francesco Urbani
% @file        : 1-stage_LC_matching.m
% @descritpion : Matlab calculations for 1 stage LC matching networks
%                Step-down (shunt-series) and step-up (series-shunt) conversions.
%                
%                RF Electronics class, Spring 2020
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


syms R1 real   % Ω  
syms X1 real   % Ω 

syms R2 real   % Ω 
syms X2 real   % Ω 

syms Xshu real   % Ω 
syms Xser real   % Ω 




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%  shunt - series  %%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%                             jXser
%                          +--------+
%           +-----------+--+        +----+
%           |           |  +--------+
%           |           |
%           |           |
%          +++         +++                                                   1
% Z1 =     | |         | | jXshu             Z2 = R2 + jX2 = jXser + -----------------
% R1 + jX1 | |         | |                                             1        1
%          +++         +++                                           ----- + --------
%           |           |                                            jXshu   R1 + jX1
%           |           |
%           |           |
%           +-----------+----------------+



% equivalent impedance
Z2 = j*Xser + 1/(1/(j*Xshu) + 1/(R1+j*X1))

pretty(Z2)
%                   1
% Xser 1i - -----------------
%            1i         1
%           ---- - ----------
%           Xshu   R1 + X1 1i

 

pretty(real(Z2))
%                          R1
% ----------------------------------------------------
%             /        2                             \
%    2     2  |      R1        /   1        X1    \2 |
% (R1  + X1 ) | ------------ + | ---- + --------- |  |
%             |    2     2 2   | Xshu     2     2 |  |
%             \ (R1  + X1 )    \        R1  + X1  /  /



pretty(imag(Z_2))
%                    1        X1
%                  ---- + ---------
%                  Xshu     2     2
%                         R1  + X1
% Xser + ------------------------------------
%               2
%             R1        /   1        X1    \2
%        ------------ + | ---- + --------- |
%           2     2 2   | Xshu     2     2 |
%        (R1  + X1 )    \        R1  + X1  /



eq1 = real(Z2) == R2 
eq2 = imag(Z2) == X2
 
S=solve(eq1,eq2, Xshu, Xser)

S.Xshu
%   (R1*X2 + R2*X1 - R1*(X2 - ((R2*(R1^2 - R2*R1 + X1^2))/R1)^(1/2)))/(R1 - R2)
%   (R1*X2 + R2*X1 - R1*(X2 + ((R2*(R1^2 - R2*R1 + X1^2))/R1)^(1/2)))/(R1 - R2)
 

S.Xser 
%   X2 - ((R2*(R1^2 - R2*R1 + X1^2))/R1)^(1/2)
%   X2 + ((R2*(R1^2 - R2*R1 + X1^2))/R1)^(1/2)
 
pretty(S.Xshu)
% /                    /          /       2             2  \ \ \
% |                    |          | R2 (R1  - R2 R1 + X1 ) | | |
% | R1 X2 + R2 X1 - R1 | X2 - sqrt| ---------------------- | | |
% |                    \          \           R1           / / |
% | ---------------------------------------------------------- |
% |                           R1 - R2                          |
% |                                                            |
% |                    /          /       2             2  \ \ |
% |                    |          | R2 (R1  - R2 R1 + X1 ) | | |
% | R1 X2 + R2 X1 - R1 | X2 + sqrt| ---------------------- | | |
% |                    \          \           R1           / / |
% | ---------------------------------------------------------- |
% \                           R1 - R2                          /



pretty(S.Xser)
% /          /       2             2  \ \
% |          | R2 (R1  - R2 R1 + X1 ) | |
% | X2 - sqrt| ---------------------- | |
% |          \           R1           / |
% |                                     |
% |          /       2             2  \ |
% |          | R2 (R1  - R2 R1 + X1 ) | |
% | X2 + sqrt| ---------------------- | |
% \          \           R1           / /


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%







clc
clear

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%  series - shunt  %%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%                     jXser
%                   +--------+
%           +-------+        +----+--------------+
%           |       +--------+    |
%           |                     |
%           |                     |
%          +++                   +++                                          1
% Z1 =     | |                   | | jXshu        Z2 = R2 + jX2 = -------------------------
% R1 + jX1 | |                   | |                                1            1
%          +++                   +++                              ----  + ----------------
%           |                     |                               jXshu   R1 + jX1 + jXser
%           |                     |
%           |                     |
%           +---------------------+---------------+



Z2 = 1/(1/(j*Xshu) + 1/(R1+j*(Xser+X1)))

pretty(Z_2)
%              1
% ---------------------------
%           1             1i
% -------------------- - ----
% R1 + X1 1i + Xser 1i   Xshu


pretty(real(Z2))
%                                        R1
% -------------------------------------------------------------------------------
% /                                             2          \
% | /      X1 + Xser         1  \2            R1           |             2     2
% | | ------------------ + ---- |  + --------------------- | ((X1 + Xser)  + R1 )
% | |            2     2   Xshu |                2     2 2 |
% \ \ (X1 + Xser)  + R1         /    ((X1 + Xser)  + R1 )  /



pretty(imag(Z2))
%                     X1 + Xser         1
%                ------------------ + ----
%                           2     2   Xshu
%                (X1 + Xser)  + R1
% ------------------------------------------------------
%                                             2
% /      X1 + Xser         1  \2            R1
% | ------------------ + ---- |  + ---------------------
% |            2     2   Xshu |                2     2 2
% \ (X1 + Xser)  + R1         /    ((X1 + Xser)  + R1 )
 



eq1 = real(Z2) == R2
eq2 = imag(Z2) == X2


S=solve(eq1,eq2, Xshu ,Xser)

S.Xshu
%   (R1*X2 + (R1*R2*(R2^2 - R1*R2 + X2^2))^(1/2))/(R1 - R2)
%   (R1*X2 - (R1*R2*(R2^2 - R1*R2 + X2^2))^(1/2))/(R1 - R2)
   

S.Xser
%   -(R2*X1 - (R1*R2*(R2^2 - R1*R2 + X2^2))^(1/2))/R2
%   -(R2*X1 + (R1*R2*(R2^2 - R1*R2 + X2^2))^(1/2))/R2
 

pretty(S.Xshu)
% /                       2             2   \
% | R1 X2 + sqrt(R1 R2 (R2  - R1 R2 + X2 )) |
% | --------------------------------------- |
% |                 R1 - R2                 |
% |                                         |
% |                       2             2   |
% | R1 X2 - sqrt(R1 R2 (R2  - R1 R2 + X2 )) |
% | --------------------------------------- |
% \                 R1 - R2                 /



pretty(S.Xser)
% /                         2             2   \
% |   R2 X1 - sqrt(R1 R2 (R2  - R1 R2 + X2 )) |
% | - --------------------------------------- |
% |                      R2                   |
% |                                           |
% |                         2             2   |
% |   R2 X1 + sqrt(R1 R2 (R2  - R1 R2 + X2 )) |
% | - --------------------------------------- |
% \                      R2                   /



