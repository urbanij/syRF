%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% @date        : Mon Mar 19 15:38:35 CEST 2018
% @author(s)   : Francesco Urbani
% @file        : 1-stage_LC_matching.m
% @descritpion : Matlab calculations for 1 stage LC matching networks
%                Step-down (shunt-series) and step-up (series-shunt) conversions.
%                
%                RF Electronics class, Spring 2018
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


syms R_1 real   % Ω  
syms X_1 real   % Ω 

syms R_2 real   % Ω 
syms X_2 real   % Ω 

syms X_a real   % Ω 
syms X_b real   % Ω 




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%  shunt - series  %%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 
%                                jX_b
%                            +--------+
%             +-----------+--+        +----+
%             |           |  +--------+
%             |           |
%             |           |
%            +++         +++
% Z_1 =      | |         | | jX_a          Z_2 = R_2 + jX_2
% R_1 + jX_1 | |         | |
%            +++         +++
%             |           |
%             |           |
%             |           |
%             +-----------+----------------+



% equivalent impedance
Z_2 = j*X_b + 1/(1/(j*X_a) + 1/(R_1+j*X_1))

pretty(Z_2)
%                   1
% X_b 1i - ------------------
%           1i         1
%          --- - ------------
%          X_a   R_1 + X_1 1i

 

real(Z_2)
pretty(real(Z_2))
%                            R_1
% ---------------------------------------------------------
%               /         2                               \
%     2      2  |      R_1         /  1        X_1     \2 |
% (R_1  + X_1 ) | -------------- + | --- + ----------- |  |
%               |     2      2 2   | X_a      2      2 |  |
%               \ (R_1  + X_1 )    \       R_1  + X_1  /  /



imag(Z_2)
pretty(imag(Z_2))
%                   1        X_1
%                  --- + -----------
%                  X_a      2      2
%                        R_1  + X_1
% X_b + ---------------------------------------
%               2
%            R_1         /  1        X_1     \2
%       -------------- + | --- + ----------- |
%           2      2 2   | X_a      2      2 |
%       (R_1  + X_1 )    \       R_1  + X_1  /



eq1 = real(Z_2) == R_2 
eq2 = imag(Z_2) == X_2
 
S=solve(eq1,eq2, X_a, X_b)

S.X_a
% (R_1*X_2 + R_2*X_1 - R_1*(X_2 - ((R_2*(R_1^2 - R_2*R_1 + X_1^2))/R_1)^(1/2)))/(R_1 - R_2)
% (R_1*X_2 + R_2*X_1 - R_1*(X_2 + ((R_2*(R_1^2 - R_2*R_1 + X_1^2))/R_1)^(1/2)))/(R_1 - R_2)
 

S.X_b
% X_2 - ((R_2*(R_1^2 - R_2*R_1 + X_1^2))/R_1)^(1/2)
% X_2 + ((R_2*(R_1^2 - R_2*R_1 + X_1^2))/R_1)^(1/2)
 

pretty(S.X_a)
% /                         /           /         2                2  \ \ \
% |                         |           | R_2 (R_1  - R_2 R_1 + X_1 ) | | |
% | R_1 X_2 + R_2 X_1 - R_1 | X_2 - sqrt| --------------------------- | | |
% |                         \           \             R_1             / / |
% | --------------------------------------------------------------------- |
% |                               R_1 - R_2                               |
% |                                                                       |
% |                         /           /         2                2  \ \ |
% |                         |           | R_2 (R_1  - R_2 R_1 + X_1 ) | | |
% | R_1 X_2 + R_2 X_1 - R_1 | X_2 + sqrt| --------------------------- | | |
% |                         \           \             R_1             / / |
% | --------------------------------------------------------------------- |
% \                               R_1 - R_2                               /



pretty(S.X_b)
% /           /         2                2  \ \
% |           | R_2 (R_1  - R_2 R_1 + X_1 ) | |
% | X_2 - sqrt| --------------------------- | |
% |           \             R_1             / |
% |                                           |
% |           /         2                2  \ |
% |           | R_2 (R_1  - R_2 R_1 + X_1 ) | |
% | X_2 + sqrt| --------------------------- | |
% \           \             R_1             / /



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%







clc
clear

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%  series - shunt  %%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%                       jX_b
%                      +--------+
%              +-------+        +----+--------------+
%              |       +--------+    |
%              |                     |
%              |                     |
%             +++                   +++
% Z_1 =       | |                   | | jX_a          Z_2 = R_2 + jX_2
% R_1 + jX_ 1 | |                   | |
%             +++                   +++
%              |                     |
%              |                     |
%              |                     |
%              +---------------------+---------------+


 
 
Z_2 = 1/(1/(j*X_a) + 1/(R_1+j*(X_b+X_1)))

pretty(Z_2)
%              1
% ---------------------------
%           1              1i
% --------------------- - ---
% R_1 + X_1 1i + X_b 1i   X_a


real(Z_2)
pretty(real(Z_2))
%                                        R_1
% ---------------------------------------------------------------------------------
% /                                              2          \
% | /      X_1 + X_b         1  \2            R_1           |             2      2
% | | ------------------- + --- |  + ---------------------- | ((X_1 + X_b)  + R_1 )
% | |            2      2   X_a |                2      2 2 |
% \ \ (X_1 + X_b)  + R_1        /    ((X_1 + X_b)  + R_1 )  /



imag(Z_2)
pretty(imag(Z_2))
%                     X_1 + X_b         1
%                ------------------- + ---
%                           2      2   X_a
%                (X_1 + X_b)  + R_1
% -------------------------------------------------------
%                                              2
% /      X_1 + X_b         1  \2            R_1
% | ------------------- + --- |  + ----------------------
% |            2      2   X_a |                2      2 2
% \ (X_1 + X_b)  + R_1        /    ((X_1 + X_b)  + R_1 )
 



eq1 = real(Z_2) == R_2
eq2 = imag(Z_2) == X_2


S=solve(eq1,eq2, X_a ,X_b)

S.X_a
% (R_1*X_2 + (R_1*R_2*(R_2^2 - R_1*R_2 + X_2^2))^(1/2))/(R_1 - R_2)
% (R_1*X_2 - (R_1*R_2*(R_2^2 - R_1*R_2 + X_2^2))^(1/2))/(R_1 - R_2)
  

S.X_b
% -(R_2*X_1 - (R_1*R_2*(R_2^2 - R_1*R_2 + X_2^2))^(1/2))/R_2
% -(R_2*X_1 + (R_1*R_2*(R_2^2 - R_1*R_2 + X_2^2))^(1/2))/R_2
  


pretty(S.X_a)
% /                            2                2   \
% | R_1 X_2 + sqrt(R_1 R_2 (R_2  - R_1 R_2 + X_2 )) |
% | ----------------------------------------------- |
% |                    R_1 - R_2                    |
% |                                                 |
% |                            2                2   |
% | R_1 X_2 - sqrt(R_1 R_2 (R_2  - R_1 R_2 + X_2 )) |
% | ----------------------------------------------- |
% \                    R_1 - R_2                    /




pretty(S.X_b)
% /                              2                2   \
% |   R_2 X_1 - sqrt(R_1 R_2 (R_2  - R_1 R_2 + X_2 )) |
% | - ----------------------------------------------- |
% |                         R_2                       |
% |                                                   |
% |                              2                2   |
% |   R_2 X_1 + sqrt(R_1 R_2 (R_2  - R_1 R_2 + X_2 )) |
% | - ----------------------------------------------- |
% \                         R_2                       /


